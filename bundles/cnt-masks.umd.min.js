!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("angular2-text-mask"),require("@angular/common"),require("@angular/forms"),require("text-mask-core/dist/textMaskCore")):"function"==typeof define&&define.amd?define("cnt-masks",["exports","@angular/core","angular2-text-mask","@angular/common","@angular/forms","text-mask-core/dist/textMaskCore"],e):e((t=t||self)["cnt-masks"]={},t.ng.core,t.angular2TextMask,t.ng.common,t.ng.forms,t.textMaskCore)}(this,(function(t,e,n,r,a,i){"use strict";var o=function(){function t(){}return t.prototype.transform=function(t){return"number"!=typeof t&&(t+=""),"string"!=typeof t?t:(3===t.length&&(t="0"+t),t.substring(0,2)+"/"+t.substring(2))},t}();o.decorators=[{type:e.Pipe,args:[{name:"cardExpiration"}]}];Object.create;function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var u,c;Object.create;var l=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};function p(t){var e,n,r,a=(t+"").replace(/\D/g,"");for(n=0,r=u.length;n<r;n++)if((e=u[n]).pattern.test(a))return e}function f(t){var e,n,r;for(n=0,r=u.length;n<r;n++)if((e=u[n]).type===t)return e}function d(t){try{if(t&&null!=t.selectionStart&&t.selectionStart!==t.selectionEnd)return!0}catch(t){t}return!1}function h(t,e,n){var r,a,i,o;if(t.length)try{for(var u=s(Array.from(t)),c=u.next();!c.done;c=u.next()){h(c.value,e,n)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}else{if(!e.match(" "))return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?(e="on"+e,t.attachEvent(e,n)):void(t["on"+e]=n);try{for(var l=s(Array.from(e.split(" "))),p=l.next();!p.done;p=l.next()){h(t,p.value,n)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}}function v(t,e,n){var r;try{r=new CustomEvent(e,{detail:n})}catch(t){(r=document.createEvent("CustomEvent")).initCustomEvent?r.initCustomEvent(e,!0,!0,n):r.initEvent(e,!0,!0,n)}return t.dispatchEvent(r)}u=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dankort",pattern:/^5019/,format:c=/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0},{type:"hipercard",pattern:/^(384100|384140|384160|606282|637095|637568|60(?!11))/,format:c,length:[14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:c,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:c,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:c,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6708|6759|676[1-3])/,format:c,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^(5[1-5]|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)/,format:c,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:c,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:c,length:[16],cvcLength:[3],luhn:!0},{type:"elo",pattern:/^(4011(78|79)|43(1274|8935)|45(1416|7393|763(1|2))|50(4175|6699|67[0-7][0-9]|9000)|627780|63(6297|6368)|650(03([^4])|04([0-9])|05(0|1)|4(0[5-9]|3[0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8])|9([2-6][0-9]|7[0-8])|541|700|720|901)|651652|655000|655021)/,format:c,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:c,length:[13,16,19],cvcLength:[3],luhn:!0}];var m=function(){function t(){}return t.restrictNumeric=function(t){return h(t,"keypress",w)},t.formatCardCVC=function(e){return t.restrictNumeric(e),h(e,"keypress",I),e},t.formatCardExpiry=function(e){var n,r;return t.restrictNumeric(e),e.length&&2===e.length?(n=e[0],r=e[1],this.formatCardExpiryMultiple(n,r)):(h(e,"keypress",L),h(e,"keypress",C),h(e,"keypress",x),h(e,"keypress",k),h(e,"keydown",M)),e},t.formatCardExpiryMultiple=function(t,e){return h(t,"keypress",b),h(t,"keypress",E),h(e,"keypress",$)},t.formatCardNumber=function(e,n){return t.restrictNumeric(e),h(e,"keypress",function(t){return function(e){var n,r=e.target,a=String.fromCharCode(e.which);if(/^\d+$/.test(a)&&!d(r)){var i=(r.value+a).replace(/\D/g,""),o=p(i);return n=16,o&&(n=o.length[o.length.length-1]),t&&(n=Math.min(n,t)),i.length<=n?void 0:e.preventDefault()}}}(n)),h(e,"keypress",function(t){return function(e){var n,r,a,i,o,s,u,c,l,f;if(r=String.fromCharCode(e.which),/^\d+$/.test(r)){for(n=p((c=(o=e.target).value)+r),i=(c.replace(/\D/g,"")+r).length,u=[16],n&&(u=n.length),t&&(u=u.filter((function(e){return e<=t}))),a=l=0,f=u.length;l<f;a=++l)if(!(i>=(s=u[a])&&u[a+1])&&i>=s)return;if(!d(o))return(n&&"amex"===n.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(c)?(e.preventDefault(),o.value=c+" "+r,v(o,"change")):void 0}}}(n)),h(e,"keydown",y),h(e,"keyup blur",N),h(e,"paste",g),h(e,"input",g),e},t}();function g(t){return setTimeout((function(){var e,n=t.target;if(n)return e=n.value,(e=m.fns.formatCardNumber(e))&&(n.value=e),v(n,"change")}))}function y(t){var e=t.target,n=e.value;if(!t.meta&&8===t.which&&!d(e))return/\d\s$/.test(n)?(t.preventDefault(),e.value=n.replace(/\d\s$/,""),v(e,"change")):/\s\d?$/.test(n)?(t.preventDefault(),e.value=n.replace(/\s\d?$/,""),v(e,"change")):void 0}function C(t){var e=String.fromCharCode(t.which);if(/^\d+$/.test(e)){var n=t.target,r=n.value+e;return/^\d$/.test(r)&&"0"!==r&&"1"!==r?(t.preventDefault(),n.value="0"+r+" / ",v(n,"change")):/^\d\d$/.test(r)?(t.preventDefault(),n.value=r+" / ",v(n,"change")):void 0}}function E(t){var e=String.fromCharCode(t.which);if(/^\d+$/.test(e)){var n=t.target,r=n.value+e;return/^\d$/.test(r)&&"0"!==r&&"1"!==r?(t.preventDefault(),n.value="0"+r,v(n,"change")):/^\d\d$/.test(r)?(t.preventDefault(),n.value=r,v(n,"change")):void 0}}function k(t){var e=String.fromCharCode(t.which);if(/^\d+$/.test(e)){var n=t.target,r=n.value;return/^\d\d$/.test(r)?(n.value=r+" / ",v(n,"change")):void 0}}function x(t){if("/"===String.fromCharCode(t.which)){var e=t.target,n=e.value;return/^\d$/.test(n)&&"0"!==n?(e.value="0"+n+" / ",v(e,"change")):void 0}}function M(t){if(!t.metaKey){var e=t.target,n=e.value;if(8===t.which&&!d(e))return/\d(\s|\/)+$/.test(n)?(t.preventDefault(),e.value=n.replace(/\d(\s|\/)*$/,""),v(e,"change")):/\s\/\s?\d?$/.test(n)?(t.preventDefault(),e.value=n.replace(/\s\/\s?\d?$/,""),v(e,"change")):void 0}}function w(t){var e;return!(!t.metaKey&&!t.ctrlKey)||(32===t.which?(t.preventDefault(),!1):0===t.which||(t.which<33||(e=String.fromCharCode(t.which),/[\d\s]/.test(e)?void 0:(t.preventDefault(),!1))))}function D(t,e){var n=t.target,r=String.fromCharCode(t.which);if(/^\d+$/.test(r)&&!d(n))return(n.value+r).replace(/\D/g,"").length>e?t.preventDefault():void 0}function L(t){return D(t,6)}function b(t){return D(t,2)}function $(t){return D(t,4)}function I(t){var e=t.target,n=String.fromCharCode(t.which);if(/^\d+$/.test(n)&&!d(e))return(e.value+n).length<=4?void 0:t.preventDefault()}function N(t){var e=t.target,n=e.value,r=m.fns.cardType(n)||"unknown";if(e&&e.classList&&!e.classList.contains(r))return e.classList.add("unknown"),u.forEach((function(t){return e.classList.remove(t.type)})),e.classList.add(r),"unknown"!==r?e.classList.contains("identified")&&e.classList.add("identified"):e.classList.remove("identified"),v(e,"payment.cardType",r)}m.fns={cardExpiryVal:function(t){var e,n,r;return e=(r=(t=t.replace(/\s/g,"")).split("/",2))[0],2===(null!=(n=r[1])?n.length:void 0)&&/^\d+$/.test(n)&&(n=(new Date).getFullYear().toString().slice(0,2)+n),{month:e,year:n}},validateCardNumber:function(t){var e,n;return t=(t+"").replace(/\s+|-/g,""),!!/^\d+$/.test(t)&&(!!(e=p(t))&&(n=t.length,l.call(e.length,n)>=0&&(!1===e.luhn||function(t){var e=!0,n=0;return(t+"").split("").reverse().forEach((function(t){var r=parseInt(t,10);return(e=!e)&&(r*=2),r>9&&(r-=9),n+=r})),n%10==0}(t))))},validateCardExpiry:function(t,e){var n,r,a;if("string"==typeof t&&l.call(t,"/")>=0&&(t=(a=m.fns.cardExpiryVal(t)).month,e=a.year),!t||!e)return!1;if(t=t.trim(),e=e.trim(),!/^\d+$/.test(t))return!1;if(!/^\d+$/.test(e))return!1;var i=parseInt(t,10);return!!(i&&i<=12)&&(2===e.length&&(e=(new Date).getFullYear().toString().slice(0,2)+e),r=new Date(parseInt(e,10),i),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>n)},validateCardCVC:function(t,e){var n,r;return t=t.trim(),!!/^\d+$/.test(t)&&(e&&f(e)?(r=f(e),n=t.length,l.call(null!=r?r.cvcLength:void 0,n)>=0):t.length>=3&&t.length<=4)},cardType:function(t){if(!t)return null;var e=p(t);return(null!=e?e.type:void 0)||null},formatCardNumber:function(t){var e,n,r;if(!(e=p(t)))return t;if(r=e.length[e.length.length-1],t=(t=t.replace(/\D/g,"")).slice(0,r),e.format.global){var a=t.match(e.format);return null!=a?a.join(" "):void 0}return null!=(n=e.format.exec(t))?(n.shift(),(n=n.filter((function(t){return t}))).join(" ")):void 0}};var T=function(t){this.el=t;var e=this.el.nativeElement;m.formatCardCVC(e),m.restrictNumeric(e)};T.decorators=[{type:e.Directive,args:[{selector:"[cntMaskCCCvc]"}]}],T.ctorParameters=function(){return[{type:e.ElementRef}]};var S=function(t){this.el=t;var e=this.el.nativeElement;m.formatCardExpiry(e),m.restrictNumeric(e)};S.decorators=[{type:e.Directive,args:[{selector:"[cntMaskCCExp]"}]}],S.ctorParameters=function(){return[{type:e.ElementRef}]};var P=function(){function t(t,e){this.renderer=t,this.el=e;var n=this.el.nativeElement;this.cardType="",m.formatCardNumber(n),m.restrictNumeric(n)}return t.prototype.onKeypress=function(t){var e=this.el.nativeElement,n=e.value;this.cardType=m.fns.cardType(n),this.cardType&&""!==this.cardType?this.renderer.removeClass(e,this.cardType):this.cardType=""},t}();P.decorators=[{type:e.Directive,args:[{selector:"[cntMaskCCNum]"}]}],P.ctorParameters=function(){return[{type:e.Renderer2},{type:e.ElementRef}]},P.propDecorators={onKeypress:[{type:e.HostListener,args:["keypress",["$event"]]}]};var O=function(){function t(){}return t.validateCardNumber=function(t){if(t&&!m.fns.validateCardNumber(t.value))return{cardNumber:!0};return null},t.validateCardExpiry=function(t){if(t){var e=t.value.split("/"),n=!1;if(e.length>1){var r=e[0].replace(/^\s+|\s+$/g,""),a=e[1].replace(/^\s+|\s+$/g,"");n=m.fns.validateCardExpiry(r,a)}if(!n)return{cardExpiry:!0}}return null},t.validateCardCvc=function(t){if(t&&!m.fns.validateCardCVC(t.value))return{cardCvc:!0};return null},t}(),R=function(t){return void 0===t&&(t=13),function(t){return["(",/[1-9]/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]}},j=function(){},V=function(){function t(t,e,n,r){this.renderer=t,this.elementRef=e,this.platformId=n,this.compositionMode=r,this.clean=!0,this.maxNumberLength=13,this.composing=!1,this.onChange=function(t){},this.onTouched=function(){},null==this.compositionMode&&(this.compositionMode=!this.isAndroid())}return t.prototype.ngOnInit=function(){this.setupMask(!0),void 0!==this.textMaskInputElement&&this.textMaskInputElement.update(this.inputElement.value)},t.prototype.ngOnChanges=function(t){this.setupMask(!0),void 0!==this.textMaskInputElement&&this.textMaskInputElement.update(this.inputElement.value)},t.prototype.onBlur=function(){this.onTouched()},t.prototype.writeValue=function(t){this.setupMask();var e=null==t?"":t;this.renderer.setProperty(this.inputElement,"value",e),void 0!==this.textMaskInputElement&&this.textMaskInputElement.update(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this.renderer.setProperty(this.elementRef.nativeElement,"disabled",t)},t.prototype.handleInput=function(t){(!this.compositionMode||this.compositionMode&&!this.composing)&&(this.setupMask(),void 0!==this.textMaskInputElement&&(this.textMaskInputElement.update(t),t=this.inputElement.value,this.clean?this.onChange(t.toString().replace(/[^\d\^\+]/gm,"")):this.onChange(t)))},t.prototype.setupMask=function(t){void 0===t&&(t=!1),this.textMaskConfig={mask:R(this.maxNumberLength),guide:!1,placeholderChar:"_",pipe:void 0,keepCharPositions:!1},this.inputElement||("INPUT"===this.elementRef.nativeElement.tagName.toUpperCase()?this.inputElement=this.elementRef.nativeElement:this.inputElement=this.elementRef.nativeElement.getElementsByTagName("INPUT")[0]),this.inputElement&&t&&(this.textMaskInputElement=i.createTextMaskInputElement(Object.assign({inputElement:this.inputElement},this.textMaskConfig)))},t.prototype.compositionStart=function(){this.composing=!0},t.prototype.compositionEnd=function(t){this.composing=!1,this.compositionMode&&this.handleInput(t)},t.prototype.isAndroid=function(){if(r.isPlatformBrowser(this.platformId)&&window&&window.navigator){var t=window.navigator.userAgent;return/android (\d+)/.test(t.toLowerCase())}return!1},t}();V.decorators=[{type:e.Directive,args:[{selector:"[cntMaskPhone]",exportAs:"cntMaskPhone",providers:[{provide:a.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return V})),multi:!0}]}]}],V.ctorParameters=function(){return[{type:e.Renderer2},{type:e.ElementRef},{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:Boolean,decorators:[{type:e.Optional},{type:e.Inject,args:[a.COMPOSITION_BUFFER_MODE]}]}]},V.propDecorators={clean:[{type:e.Input}],maxNumberLength:[{type:e.Input}],onBlur:[{type:e.HostListener,args:["blur"]}],handleInput:[{type:e.HostListener,args:["input",["$event.target.value"]]}],compositionStart:[{type:e.HostListener,args:["compositionstart"]}],compositionEnd:[{type:e.HostListener,args:["compositionend",["$event.target.value"]]}]};var A=function(){function t(){}return t.prototype.transform=function(t){return t?n.conformToMask(t,R(),{guide:!1}).conformedValue:""},t}();A.decorators=[{type:e.Pipe,args:[{name:"cntMaskPhone"}]}];var F=function(){};F.decorators=[{type:e.NgModule,args:[{imports:[n.TextMaskModule],declarations:[P,S,T,o,V,A],exports:[P,S,T,o,V,A]}]}],t.CCCvcFormatDirective=T,t.CCExpiryFormatDirective=S,t.CCNumberFormatDirective=P,t.CardExpirationPipe=o,t.CntMasksModule=F,t.CreditCardValidator=O,t.PhoneMaskDirective=V,t.PhoneMaskPipe=A,t.TextMaskConfig=j,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=cnt-masks.umd.min.js.map